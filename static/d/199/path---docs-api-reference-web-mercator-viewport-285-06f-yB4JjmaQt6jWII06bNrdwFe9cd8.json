{"data":{"docBySlug":{"html":"<h1 id=\"webmercatorviewport\"><a href=\"#webmercatorviewport\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WebMercatorViewport</h1>\n<p>The main purpose of the <code class=\"language-text\">PerspectiveMercatorViewport</code> is to enable 3D rendering to\nseamlessly overlay on top of map components that take web mercator style\nmap coordinates (<code class=\"language-text\">lat</code>, <code class=\"language-text\">lon</code>, <code class=\"language-text\">zoom</code>, <code class=\"language-text\">pitch</code>, <code class=\"language-text\">bearing</code> etc),\nand to facilite the necessary mercator projections by breaking them into a\nminimal non-linear piece followed by a standard projection chain.</p>\n<h2 id=\"methods\"><a href=\"#methods\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Methods</h2>\n<h3 id=\"constructor\"><a href=\"#constructor\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Constructor</h3>\n<table>\n<thead>\n<tr>\n<th>Parameter</th>\n<th>Type</th>\n<th>Default</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">width</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">1</code></td>\n<td>Width of \"viewport\" or window</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">height</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">1</code></td>\n<td>Height of \"viewport\" or window</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">latitude</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">37</code></td>\n<td>Center of viewport on map (alternative to center)</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">longitude</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">-122</code></td>\n<td>Center of viewport on map (alternative to center)</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">zoom</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">11</code></td>\n<td>Scale = Math.pow(2,zoom) on map (alternative to opt.scale)</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">pitch</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">0</code></td>\n<td>Camera angle in degrees (0 is straight down)</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">bearing</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">0</code></td>\n<td>Map rotation in degrees (0 means north is up)</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">altitude</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">1.5</code></td>\n<td>Altitude of camera in screen units</td>\n</tr>\n</tbody>\n</table>\n<p>Remarks:</p>\n<ul>\n<li>Altitude has a default value that matches assumptions in mapbox-gl</li>\n<li><code class=\"language-text\">width</code> and <code class=\"language-text\">height</code> are forced to 1 if supplied as 0, to avoid\ndivision by zero. This is intended to reduce the burden of apps to\nto check values before instantiating a <code class=\"language-text\">Viewport</code>.</li>\n<li>When using mercatorProjection, per cartographic tradition, longitudes and\nlatitudes are specified as degrees.</li>\n</ul>\n<h3 id=\"code-classlanguage-textprojectlnglatz-optscode\"><a href=\"#code-classlanguage-textprojectlnglatz-optscode\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">project(lngLatZ, opts)</code></h3>\n<p>Projects latitude and longitude to pixel coordinates on screen.</p>\n<table>\n<thead>\n<tr>\n<th>Parameter</th>\n<th>Type</th>\n<th>Default</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">lngLatZ</code></td>\n<td><code class=\"language-text\">Array</code></td>\n<td>(required)</td>\n<td>map coordinates, <code class=\"language-text\">[lng, lat]</code> or <code class=\"language-text\">[lng, lat, Z]</code> where <code class=\"language-text\">Z</code> is elevation in meters</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">opts</code></td>\n<td><code class=\"language-text\">Object</code></td>\n<td><code class=\"language-text\">{}</code></td>\n<td>named options</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">opts.topLeft</code></td>\n<td><code class=\"language-text\">Boolean</code></td>\n<td><code class=\"language-text\">true</code></td>\n<td>If <code class=\"language-text\">true</code> projected coords are top left, otherwise bottom left</td>\n</tr>\n</tbody>\n</table>\n<p>Returns: <code class=\"language-text\">[x, y]</code> or <code class=\"language-text\">[x, y, z]</code> in pixels coordinates. <code class=\"language-text\">z</code> is pixel depth.</p>\n<ul>\n<li>If input is <code class=\"language-text\">[lng, lat]</code>: returns <code class=\"language-text\">[x, y]</code>.</li>\n<li>If input is <code class=\"language-text\">[lng, lat, Z]</code>: returns <code class=\"language-text\">[x, y, z]</code>.</li>\n</ul>\n<p>Remarks:</p>\n<ul>\n<li>By default, returns top-left coordinates suitable for canvas/SVG type\nrendering.</li>\n</ul>\n<h3 id=\"code-classlanguage-textunprojectxyz-optscode\"><a href=\"#code-classlanguage-textunprojectxyz-optscode\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">unproject(xyz, opts)</code></h3>\n<p>Unproject pixel coordinates on screen to longitude and latitude on map.</p>\n<table>\n<thead>\n<tr>\n<th>Parameter</th>\n<th>Type</th>\n<th>Default</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">xyz</code></td>\n<td><code class=\"language-text\">Array</code></td>\n<td>(required)</td>\n<td>pixel coordinates, <code class=\"language-text\">[x, y]</code> or <code class=\"language-text\">[x, y, z]</code> where <code class=\"language-text\">z</code> is pixel depth</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">opts</code></td>\n<td><code class=\"language-text\">Object</code></td>\n<td><code class=\"language-text\">{}</code></td>\n<td>named options</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">opts.topLeft</code></td>\n<td><code class=\"language-text\">Boolean</code></td>\n<td><code class=\"language-text\">true</code></td>\n<td>If <code class=\"language-text\">true</code> projected coords are top left, otherwise bottom left</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">opts.targetZ</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">0</code></td>\n<td>If pixel depth <code class=\"language-text\">z</code> is not specified in <code class=\"language-text\">xyz</code>, use <code class=\"language-text\">opts.targetZ</code> as the desired elevation</td>\n</tr>\n</tbody>\n</table>\n<p>Returns: <code class=\"language-text\">[lng, lat]</code> or <code class=\"language-text\">[longitude, lat, Z]</code> in map coordinates. <code class=\"language-text\">Z</code> is elevation in meters.</p>\n<ul>\n<li>If input is <code class=\"language-text\">[x, y]</code> without specifying <code class=\"language-text\">opts.targetZ</code>: returns <code class=\"language-text\">[lng, lat]</code>.</li>\n<li>If input is <code class=\"language-text\">[x, y]</code> with <code class=\"language-text\">opts.targetZ</code>: returns <code class=\"language-text\">[lng, lat, targetZ]</code>.</li>\n<li>If input is <code class=\"language-text\">[x, y, z]</code>: returns <code class=\"language-text\">[lng, lat, Z]</code>.</li>\n</ul>\n<h4 id=\"code-classlanguage-textprojectflatlnglat-scalecode\"><a href=\"#code-classlanguage-textprojectflatlnglat-scalecode\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">projectFlat(lngLat, scale)</code></h4>\n<p>Project longitude and latitude onto Web Mercator coordinates.</p>\n<table>\n<thead>\n<tr>\n<th>Parameter</th>\n<th>Type</th>\n<th>Default</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">lngLat</code></td>\n<td><code class=\"language-text\">Array</code></td>\n<td>(required)</td>\n<td>map coordinates, <code class=\"language-text\">[lng, lat]</code></td>\n</tr>\n<tr>\n<td><code class=\"language-text\">scale</code></td>\n<td><code class=\"language-text\">Number</code></td>\n<td><code class=\"language-text\">this.scale</code></td>\n<td>Web Mercator scale</td>\n</tr>\n</tbody>\n</table>\n<p>Returns:</p>\n<ul>\n<li><code class=\"language-text\">[x, y]</code>, representing Web Mercator coordinates.</li>\n</ul>\n<h4 id=\"code-classlanguage-textunprojectflatxy-scalecode\"><a href=\"#code-classlanguage-textunprojectflatxy-scalecode\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">unprojectFlat(xy, scale)</code></h4>\n<p>Unprojects a Web Mercator coordinate to longitude and latitude.\n| Parameter      | Type      | Default  | Description                     |\n| -------------- | --------- | -------- | ------------------------------- |\n| <code class=\"language-text\">xy</code>          | <code class=\"language-text\">Array</code>   | (required) | Web Mercator coordinates, <code class=\"language-text\">[x, y]</code>   |\n| <code class=\"language-text\">scale</code>         | <code class=\"language-text\">Number</code>  | <code class=\"language-text\">this.scale</code>     | Web Mercator scale  |</p>\n<p>Returns:</p>\n<ul>\n<li><code class=\"language-text\">[longitude, latitude]</code></li>\n</ul>\n<h4 id=\"code-classlanguage-textfitboundsbounds-optionscode\"><a href=\"#code-classlanguage-textfitboundsbounds-optionscode\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">fitBounds(bounds, options)</code></h4>\n<p>Get a new flat viewport that fits around the given bounding box.</p>\n<ul>\n<li><code class=\"language-text\">bounds</code> ([[Number,Number],[Number,Number]]) - an array of two opposite corners of\nthe bounding box. Each corner is specified in <code class=\"language-text\">[lon, lat]</code>.</li>\n<li>\n<p><code class=\"language-text\">options</code> (Object)</p>\n<ul>\n<li><code class=\"language-text\">options.padding</code> (Number|{top:Number, bottom: Number, left: Number, right: Number}, optional) - The amount of\npadding in pixels to add to the given bounds from the edge of the viewport. If padding is set as object, all parameters are\nrequired.</li>\n<li><code class=\"language-text\">options.offset</code> ([Number,Number], optional) - The center of the given bounds relative to the viewport's center, <code class=\"language-text\">[x, y]</code> measured in pixels.</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"code-classlanguage-textgetmapcenterbylnglatpositionoptscode\"><a href=\"#code-classlanguage-textgetmapcenterbylnglatpositionoptscode\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a><code class=\"language-text\">getMapCenterByLngLatPosition(opts)</code></h4>\n<p>Returns the map center that place a given [lng, lat] coordinate at screen point [x, y].</p>\n<p>Parameters:</p>\n<ul>\n<li><code class=\"language-text\">opts</code> (Object) - options</li>\n<li><code class=\"language-text\">opts.lngLat</code> (Array, required) - [lng,lat] coordinates of a location on the sphere.</li>\n<li><code class=\"language-text\">opts.pos</code> (Array, required) - [x,y] coordinates of a pixel on screen.</li>\n</ul>\n<p>Returns:</p>\n<ul>\n<li><code class=\"language-text\">[longitude, latitude]</code> new map center</li>\n</ul>","timeToRead":5,"excerpt":"WebMercatorViewport The main purpose of the   is to enable 3D rendering to\nseamlessly overlay on top of map components that take webâ€¦","frontmatter":{"title":"WebMercatorViewport","cover":"cover","category":"docs","tags":["default"]}}},"pageContext":{"relativeLinks":{"../../README.md":"/docs","docs/README.md":"/docs","../..":"/docs","docs":"/docs","../../whats-new.md":"/docs/whats-new","docs/whats-new.md":"/docs/whats-new","../../whats-new":"/docs/whats-new","docs/whats-new":"/docs/whats-new","../../articles/coordinates.md":"/docs/articles/coordinates","docs/articles/coordinates.md":"/docs/articles/coordinates","../../articles/coordinates":"/docs/articles/coordinates","docs/articles/coordinates":"/docs/articles/coordinates","../../articles/offset-accuracy.md":"/docs/articles/offset-accuracy","docs/articles/offset-accuracy.md":"/docs/articles/offset-accuracy","../../articles/offset-accuracy":"/docs/articles/offset-accuracy","docs/articles/offset-accuracy":"/docs/articles/offset-accuracy","../web-mercator-utils.md":"/docs/api-reference/web-mercator-utils","docs/api-reference/web-mercator-utils.md":"/docs/api-reference/web-mercator-utils","../web-mercator-utils":"/docs/api-reference/web-mercator-utils","docs/api-reference/web-mercator-utils":"/docs/api-reference/web-mercator-utils","":"/docs/api-reference/web-mercator-viewport","docs/api-reference/web-mercator-viewport.md":"/docs/api-reference/web-mercator-viewport","docs/api-reference/web-mercator-viewport":"/docs/api-reference/web-mercator-viewport","../../get-started/README.md":"/docs/get-started","docs/get-started/README.md":"/docs/get-started","../../get-started":"/docs/get-started","docs/get-started":"/docs/get-started"},"slug":"docs/api-reference/web-mercator-viewport","toc":"docs"}}